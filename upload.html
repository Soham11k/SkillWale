<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Upload Resume | SkillWale</title>
  <!-- Fonts & Animation Libraries -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
  <script src="https://unpkg.com/@lottiefiles/lottie-player"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-radar"></script>
  <style>
    :root {
      --bg: #0a0a2f;
      --surface: #12123b;
      --text: #ffffff;
      --subtle: #aaaaaa;
      --accent1: #FFDD33;
      --accent2: #FF4F0F;
      --accent3: #FF66B3;
      --glass: rgba(255,255,255,0.04);
      --glow-gradient: linear-gradient(90deg, #FFDD33, #FF66B3, #00F0FF);
    }
    :root[data-theme='light'] {
      --bg: #f7f7fa;
      --surface: #fff;
      --text: #181818;
      --subtle: #555;
      --accent1: #FFD600;
      --accent2: #FF4F0F;
      --accent3: #FF66B3;
      --glass: rgba(0,0,0,0.04);
      --glow-gradient: linear-gradient(90deg, #FFD600, #FF66B3, #00F0FF);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Space Grotesk', sans-serif;
      overflow-x: hidden;
      scroll-behavior: smooth;
      min-height: 100vh;
    }
    /* Aurora Background */
    #aurora-bg { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none; }
    /* Glassy Navbar */
    header {
      position: sticky; top: 0; z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 20px 40px; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
      border-radius: 0 0 22px 22px;
    }
    .logo {
      font-size: 2.4rem; font-weight: 600;
      animation: fadeInDown 1s ease forwards;
    }
    .logo span { color: var(--accent1); }
    nav {
      display: flex;
    }
    nav a {
      margin-left: 30px;
      color: var(--subtle);
      text-decoration: none;
      font-weight: 500;
      position: relative;
      padding-bottom: 4px;
      transition: color .3s ease;
    }
    nav a::after {
      content: '';
      position: absolute; bottom: 0;
      left: 0; width: 0; height: 2px;
      background: var(--accent2);
      transition: width .35s ease;
    }
    nav a:hover {
      color: var(--accent2);
    }
    nav a:hover::after {
      width: 100%;
    }
    /* Hero Section */
    .hero {
      text-align: center; padding: 120px 20px 80px;
      position: relative; overflow: visible;
      z-index: 2;
    }
    .hero-bg-blur {
      position: absolute; top: -150px; left: -150px;
      width: 600px; height: 600px;
      background: var(--glow-gradient);
      filter: blur(200px);
      opacity: 0.35;
      animation: pulse 6s ease-in-out infinite alternate;
      z-index: 0;
    }
    @keyframes pulse {
      from { transform: scale(0.9); }
      to { transform: scale(1.1); }
    }
    .hero h1 {
      font-size: 3.8rem; color: var(--accent2);
      margin-bottom: 20px;
      background: linear-gradient(90deg, var(--accent2), var(--accent1), var(--accent3), var(--accent2));
      background-size: 200% auto;
      color: transparent;
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientMove 3s ease-in-out infinite alternate, bounceIn 1.2s cubic-bezier(.68,-0.55,.27,1.55) 1;
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
    @keyframes bounceIn {
      0% { transform: scale(0.8) translateY(60px); opacity: 0; }
      60% { transform: scale(1.05) translateY(-10px); opacity: 1; }
      80% { transform: scale(0.97) translateY(5px); }
      100% { transform: scale(1) translateY(0); }
    }
    .hero .typing {
      font-size: 1.25rem;
      color: var(--subtle);
      border-right: 2px solid var(--accent1);
      width: 0;
      overflow: hidden;
      margin: 0 auto;
      animation: typing 3.5s steps(40,end) 0.8s 1 normal both,
                 blink 0.7s step-end infinite;
    }
    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }
    @keyframes blink {
      50% { border-color: transparent; }
    }
    .cta {
      margin-top: 32px;
      padding: 16px 48px;
      border: none;
      border-radius: 30px;
      font-size: 1.2rem;
      font-weight: 600;
      background: var(--accent1);
      color: var(--bg);
      cursor: pointer;
      box-shadow: 0 8px 22px rgba(255,221,51,0.3);
      animation: fadeInUp 1.4s cubic-bezier(.68,-0.55,.27,1.55) 1, ctaPulse 2.5s 2.2s infinite alternate;
      transition: all .3s ease;
    }
    .cta:hover {
      transform: scale(1.09) translateY(-6px) rotate(-2deg);
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      color: var(--text);
      box-shadow: 0 16px 40px rgba(255,79,15,0.25);
      letter-spacing: 1px;
    }
    @keyframes ctaPulse {
      0% { box-shadow: 0 8px 22px rgba(255,221,51,0.3); }
      100% { box-shadow: 0 16px 40px rgba(255,221,51,0.5); }
    }
    .hero lottie-player {
      width: 380px; margin: 40px auto;
      animation: fadeInUp 1.4s ease forwards;
      z-index: 1;
      position: relative;
    }
    /* Glassmorphic Upload Card */
    .upload-card {
      background: var(--glass);
      border-radius: 32px;
      padding: 48px 32px 40px 32px;
      max-width: 540px;
      width: 100%;
      box-shadow: 0 0 40px 0 var(--accent3), 0 0 0 6px var(--glass);
      backdrop-filter: blur(16px);
      border: 3px solid;
      border-image: linear-gradient(120deg, var(--accent1), var(--accent3), var(--accent2), var(--accent1)) 1;
      text-align: center;
      animation: fadeInUp 1s ease;
      position: relative;
      z-index: 3;
      margin: 0 auto;
      transition: box-shadow .4s, border .4s, background 0.5s cubic-bezier(.68,-0.55,.27,1.55), color 0.5s cubic-bezier(.68,-0.55,.27,1.55);
    }
    .drop-box {
      border: 2.5px dashed var(--accent1);
      padding: 44px 24px;
      border-radius: 18px;
      background: rgba(255,255,255,0.03);
      position: relative;
      transition: box-shadow .3s, border-color .3s, background .3s;
      margin-bottom: 18px;
      cursor: pointer;
      box-shadow: 0 0 0 2px var(--accent1), 0 2px 16px var(--accent3);
      overflow: hidden;
    }
    .drop-box:hover, .drop-box.dragover {
      background: rgba(255,255,255,0.07);
      border-color: var(--accent3);
      box-shadow: 0 0 0 6px var(--accent3), 0 4px 24px var(--accent2);
    }
    .drop-box input { display: none; }
    .drop-box i {
      font-size: 3.2rem;
      color: var(--accent1);
      transition: color .3s;
    }
    .drop-box:hover i, .drop-box.dragover i {
      color: var(--accent3);
    }
    .drop-box span {
      display: block;
      margin-top: 14px;
      font-size: 1.08rem;
      color: var(--subtle);
    }
    .file-info {
      margin-top: 20px;
      display: none;
      color: var(--text);
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-size: 1.08rem;
      display: flex;
    }
    .file-info strong {
      color: var(--accent3);
      margin-right: 6px;
      font-weight: 600;
    }
    .file-info .checkmark {
      display: inline-block;
      color: var(--accent1);
      font-size: 1.3em;
      margin-left: 4px;
      vertical-align: middle;
      animation: fadeInUp 0.6s;
    }
    .upload-btn {
      margin-top: 32px;
      padding: 16px 48px;
      border: none;
      border-radius: 30px;
      font-size: 1.2rem;
      font-weight: 600;
      background: var(--accent1);
      color: var(--bg);
      cursor: pointer;
      box-shadow: 0 8px 22px rgba(255,221,51,0.3);
      animation: fadeInUp 1.4s cubic-bezier(.68,-0.55,.27,1.55) 1, ctaPulse 2.5s 2.2s infinite alternate;
      transition: all .3s ease;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    .upload-btn:hover {
      transform: scale(1.09) translateY(-6px) rotate(-2deg);
      background: linear-gradient(90deg, var(--accent2), var(--accent1));
      color: var(--text);
      box-shadow: 0 16px 40px rgba(255,79,15,0.25);
      letter-spacing: 1px;
    }
    .upload-btn:active {
      transform: scale(0.97) translateY(2px);
      box-shadow: 0 4px 12px rgba(255,221,51,0.18);
    }
    .upload-btn .ripple-effect {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: ripple-animate 0.6s linear;
      background: var(--accent2);
      opacity: 0.25;
      pointer-events: none;
      z-index: 2;
    }
    @keyframes ripple-animate {
      to {
        transform: scale(2.5);
        opacity: 0;
      }
    }
    /* Results Section */
    .results-section {
      margin: 60px auto 0 auto;
      max-width: 900px;
      width: 100%;
      display: none;
      flex-direction: column;
      align-items: center;
      z-index: 4;
    }
    .result-card {
      background: var(--surface);
      border-radius: 18px;
      box-shadow: 0 2px 18px rgba(0,0,0,0.10);
      margin-bottom: 32px;
      padding: 32px 28px 24px 28px;
      width: 100%;
      max-width: 540px;
      animation: fadeInUp 1s both;
      position: relative;
      border: 2.5px solid var(--glass);
      transition: box-shadow .3s, border .3s, background 0.5s, color 0.5s;
    }
    .result-card.top-match {
      border: 2.5px solid var(--accent1);
      box-shadow: 0 0 32px 0 var(--accent1), 0 0 0 6px var(--glass);
      animation: fadeInUp 1.2s both, pulse 2.5s 1.2s infinite alternate;
    }
    .result-company-logo {
      height: 38px; margin-bottom: 10px; filter: grayscale(1) brightness(1.1);
    }
    .result-role {
      font-size: 1.3rem; font-weight: 600; color: var(--accent2); margin-bottom: 4px;
    }
    .result-company {
      color: var(--subtle); font-size: 1.08rem; margin-bottom: 8px;
    }
    .result-salary {
      color: var(--accent1); font-size: 1.08rem; margin-bottom: 8px;
    }
    .result-score {
      margin-bottom: 12px; display: flex; align-items: center; gap: 12px;
    }
    .circular-score {
      position: relative; width: 56px; height: 56px;
    }
    .circular-score svg {
      position: absolute; top: 0; left: 0;
    }
    .score-text {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      font-size: 1.18rem; font-weight: 700; color: var(--accent2);
    }
    .skills-list {
      display: flex; flex-wrap: wrap; gap: 8px; margin: 12px 0 8px 0;
    }
    .skill-badge {
      padding: 6px 14px; border-radius: 16px; font-size: 0.98rem; font-weight: 500;
      background: var(--glass); color: var(--text); border: 1.5px solid var(--glass);
      transition: background .3s, color .3s, border .3s;
    }
    .skill-badge.matched {
      background: var(--accent1); color: var(--bg); border-color: var(--accent1);
    }
    .skill-badge.missing {
      background: var(--surface); color: var(--accent2); border-color: var(--accent2);
    }
    .improvement-tips {
      margin-top: 10px; color: var(--accent3); font-size: 1.01rem; background: var(--glass); border-radius: 10px; padding: 10px 16px;
    }
    .result-badge {
      position: absolute; top: -18px; right: 18px; background: var(--accent1); color: var(--bg); font-weight: 700; font-size: 1.01rem; border-radius: 12px; padding: 4px 16px; box-shadow: 0 2px 8px rgba(255,221,51,0.13);
      animation: fadeInDown 1.1s;
    }
    /* Floating Tips Box */
    .tips-box {
      position:fixed;bottom:32px;right:32px;z-index:99;background:var(--surface);box-shadow:0 4px 24px rgba(0,0,0,0.13);border-radius:18px;padding:22px 28px;max-width:340px;display:flex;align-items:flex-start;gap:16px;animation:fadeInUp 1.2s;
    }
    /* Responsive and accessibility tweaks */
    @media (max-width: 900px) {
      .hero h1 { font-size: 2.4rem; }
      .upload-card, .results-section { max-width: 98vw; }
    }
    @media (max-width: 600px) {
      .hero h1 { font-size: 1.5rem; }
      .upload-card { margin-top: 0 !important; }
    }
  </style>
</head>
<body>
  <!-- Glassy Sticky Navigation Bar (from index.html) -->
  <header>
    <div class="logo">Skill<span>Wale</span></div>
    <nav class="main-nav">
      <a href="/" class="navbar-link">Home</a>
      <a href="#features" class="navbar-link">Features</a>
      <a href="/upload" class="navbar-link active">Upload</a>
      <a href="/courses" class="navbar-link">Courses</a>
      <a href="/login" class="navbar-link">Login</a>
    </nav>
    <button id="hamburger" aria-label="Open navigation" style="display:none; background:none; border:none; font-size:2rem; color:var(--accent1); margin-left:18px; cursor:pointer;">
      <span>&#9776;</span>
    </button>
    <button id="themeToggle" title="Toggle dark/light mode" style="margin-left:12px; background:var(--surface); color:var(--accent1); border:none; border-radius:50%; width:40px; height:40px; font-size:1.3rem; cursor:pointer; box-shadow:0 2px 8px rgba(0,0,0,0.12); transition:background .3s;">🌙</button>
    <nav id="mobileNav" style="display:none; position:fixed; top:0; right:0; width:70vw; max-width:320px; height:100vh; background:var(--surface); box-shadow:-2px 0 24px rgba(0,0,0,0.18); z-index:2000; flex-direction:column; align-items:flex-start; padding:48px 28px; gap:28px;">
      <button id="closeMobileNav" aria-label="Close navigation" style="background:none; border:none; font-size:2rem; color:var(--accent2); align-self:flex-end; margin-bottom:24px; cursor:pointer;">&times;</button>
      <a href="/" class="navbar-link">Home</a>
      <a href="#features" class="navbar-link">Features</a>
      <a href="/upload" class="navbar-link active">Upload</a>
      <a href="/courses" class="navbar-link">Courses</a>
      <a href="/login" class="navbar-link">Login</a>
    </nav>
  </header>
  <!-- Aurora Mesh Animated Background -->
  <canvas id="aurora-bg" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none;"></canvas>
  <!-- Animated Hero Background Blur (from index.html) -->
  <div class="hero-bg-blur"></div>
  <section class="hero" tabindex="0" aria-label="Hero section: Upload your resume" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;">
    <!-- Animated Glow Behind Mascot/Upload Card -->
    <div class="hero-glow" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:600px;height:340px;background:var(--glow-gradient);filter:blur(120px);opacity:0.32;z-index:0;animation:pulseGlow 7s ease-in-out infinite alternate;"></div>
    <div class="mascot-anim" id="mascotAnim" style="position:relative;display:inline-block;outline:none;" tabindex="0" aria-label="Mascot: SkillWale AI Buddy">
      <div id="mascotSpeech" class="mascot-speech" style="display:none;position:absolute;bottom:110px;left:50%;transform:translateX(-50%);background:var(--surface);color:var(--text);padding:18px 26px;border-radius:18px;box-shadow:0 4px 24px rgba(0,0,0,0.13);font-size:1.08rem;max-width:320px;z-index:10;animation:fadeInUp 0.7s;pointer-events:none;">
        <span id="mascotSpeechText"></span>
      </div>
      <lottie-player id="mascotLottie" src="https://assets5.lottiefiles.com/packages/lf20_oGlWy5.json" background="transparent" speed="1" style="width: 120px; height: 120px;cursor:pointer;outline:none;" loop autoplay aria-label="Mascot animation"></lottie-player>
    </div>
    <div class="hero-headline animate__animated animate__fadeInDown">Upload Your Resume. Get Matched Instantly.</div>
    <div class="hero-sub animate__animated animate__fadeInUp animate__delay-1s">AI-powered analysis, tailored job matches, and actionable tips to help you land your dream role.</div>
  </section>
  <main>
    <div class="upload-card" tabindex="0" aria-label="Resume upload form">
      <form id="uploadForm" enctype="multipart/form-data" autocomplete="off">
        <div class="drop-box" id="dropBox" tabindex="0" aria-label="Drag and drop your resume or click to select">
          <i class="fa-solid fa-cloud-upload-alt"></i>
          <span id="dropText">Drag & drop your resume (PDF, DOCX, TXT) or click to select</span>
          <input type="file" id="resumeInput" name="resume" accept=".pdf,.doc,.docx,.txt" required aria-label="Resume file input" />
        </div>
        <div class="file-info" id="fileInfo" style="display:none;">
          <strong id="fileName"></strong>
          <span class="checkmark" id="fileCheck" style="display:none;">✔️</span>
        </div>
        <textarea name="description" id="description" rows="3" placeholder="Describe your dream job or target role (optional)" style="width:100%;margin-top:18px;padding:12px 16px;border-radius:12px;border:1.5px solid var(--glass);background:var(--surface);color:var(--text);font-size:1.05rem;resize:none;transition:border .3s;"></textarea>
        <button type="submit" class="upload-btn" id="analyzeBtn" aria-label="Analyze Resume">Analyze Resume</button>
      </form>
      <div class="status-msg" id="statusMsg" style="display:none;">Analyzing your resume...</div>
    </div>
    <!-- How it Works Section (from index.html) -->
    <section class="how-it-works" style="padding: 70px 0 40px; background: var(--surface);">
      <h2 style="text-align:center; font-size:2.2rem; color:var(--accent1); margin-bottom:40px; letter-spacing:1px;">How it Works</h2>
      <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:40px; max-width:900px; margin:0 auto;">
        <div style="flex:1 1 220px; min-width:220px; max-width:260px; background:var(--glass); border-radius:18px; padding:32px 20px; text-align:center; box-shadow:0 2px 16px rgba(0,0,0,0.07);">
          <div style="font-size:2.5rem; margin-bottom:18px;">📤</div>
          <h3 style="font-size:1.2rem; color:var(--accent2); margin-bottom:10px;">Upload Resume</h3>
          <p style="color:var(--subtle); font-size:1rem;">Easily upload your CV or LinkedIn profile in seconds.</p>
        </div>
        <div style="flex:1 1 220px; min-width:220px; max-width:260px; background:var(--glass); border-radius:18px; padding:32px 20px; text-align:center; box-shadow:0 2px 16px rgba(0,0,0,0.07);">
          <div style="font-size:2.5rem; margin-bottom:18px;">🤖</div>
          <h3 style="font-size:1.2rem; color:var(--accent2); margin-bottom:10px;">Get Matched</h3>
          <p style="color:var(--subtle); font-size:1rem;">Our AI instantly analyzes and matches you to top roles.</p>
        </div>
        <div style="flex:1 1 220px; min-width:220px; max-width:260px; background:var(--glass); border-radius:18px; padding:32px 20px; text-align:center; box-shadow:0 2px 16px rgba(0,0,0,0.07);">
          <div style="font-size:2.5rem; margin-bottom:18px;">🚀</div>
          <h3 style="font-size:1.2rem; color:var(--accent2); margin-bottom:10px;">Upskill Fast</h3>
          <p style="color:var(--subtle); font-size:1rem;">Get personalized course recommendations to close your skill gaps.</p>
        </div>
      </div>
    </section>
    <!-- Results Section: AI-driven -->
    <section class="results-section" id="resultsSection">
      <!-- Results will be injected here by JS -->
    </section>
  </main>
  <!-- Floating AI Tips Box -->
  <div class="tips-box" id="aiTipsBox" style="display:none;">
    <i class="fa-solid fa-lightbulb" style="color:var(--accent1);font-size:2.1rem;animation:pulse 2.5s infinite alternate;"></i>
    <div id="aiTipsContent"></div>
  </div>
  <!-- Add a modal for interview questions -->
<div id="interviewModal" class="modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(10,10,47,0.92);z-index:9999;align-items:center;justify-content:center;">
  <div class="modal-content" style="background:var(--surface);padding:36px 28px;border-radius:22px;max-width:420px;width:90vw;box-shadow:0 8px 40px rgba(0,0,0,0.18);position:relative;">
    <button id="closeInterviewModal" style="position:absolute;top:18px;right:18px;background:none;border:none;font-size:2rem;color:var(--accent2);cursor:pointer;">&times;</button>
    <h2 style="color:var(--accent1);margin-bottom:18px;">AI Interview Questions</h2>
    <ul id="interviewQuestionsList" style="color:var(--text);font-size:1.12rem;line-height:1.7;"></ul>
  </div>
</div>
<!-- Add a download report button -->
<div style="text-align:center;margin:32px 0;">
  <button id="downloadReportBtn" class="upload-btn" style="background:var(--accent2);color:var(--text);font-size:1.1rem;">Download Full Report</button>
</div>
  <!-- Footer (from index.html) -->
  <footer style="text-align: center; padding: 60px 0 40px; font-size: 0.9rem; color: var(--subtle); background: #0b0025;">
    &copy; 2025 <strong>SkillWale</strong>. Built with 🧡 by Dreamers & Designers.
    <br><br>
    <a href="/privacy" style="color: var(--accent1); margin: 0 12px;">Privacy</a> |
    <a href="/terms" style="color: var(--accent1); margin: 0 12px;">Terms</a> |
    <a href="/contact" style="color: var(--accent1); margin: 0 12px;">Contact</a>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    // Theme toggle logic (from index.html)
    const themeToggle = document.getElementById('themeToggle');
    const root = document.documentElement;
    function setTheme(theme) {
      root.setAttribute('data-theme', theme);
      document.body.setAttribute('data-theme', theme);
      themeToggle.textContent = theme === 'dark' ? '🌙' : '☀️';
    }
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    setTheme(savedTheme ? savedTheme : (prefersDark ? 'dark' : 'light'));
    themeToggle.addEventListener('click', () => {
      const newTheme = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      setTheme(newTheme);
      localStorage.setItem('theme', newTheme);
    });
    // Hamburger menu logic (from index.html)
    const hamburger = document.getElementById('hamburger');
    const mobileNav = document.getElementById('mobileNav');
    const closeMobileNav = document.getElementById('closeMobileNav');
    hamburger.addEventListener('click', () => {
      mobileNav.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    });
    closeMobileNav.addEventListener('click', () => {
      mobileNav.style.display = 'none';
      document.body.style.overflow = '';
    });
    mobileNav.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        mobileNav.style.display = 'none';
        document.body.style.overflow = '';
      });
    });
    // Drag-and-drop, file preview, and AI-powered results rendering
    const dropBox = document.getElementById('dropBox');
    const resumeInput = document.getElementById('resumeInput');
    const fileInfo = document.getElementById('fileInfo');
    const fileName = document.getElementById('fileName');
    const fileCheck = document.getElementById('fileCheck');
    const uploadForm = document.getElementById('uploadForm');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const statusMsg = document.getElementById('statusMsg');
    const resultsSection = document.getElementById('resultsSection');
    const aiTipsBox = document.getElementById('aiTipsBox');
    const aiTipsContent = document.getElementById('aiTipsContent');
    const analyzingOverlay = document.getElementById('analyzingOverlay');
    const analyzingBarFill = document.getElementById('analyzingBarFill');

    // Drag-and-drop logic
    dropBox.addEventListener('click', () => resumeInput.click());
    dropBox.addEventListener('dragover', e => {
      e.preventDefault();
      dropBox.classList.add('dragover');
    });
    dropBox.addEventListener('dragleave', e => {
      e.preventDefault();
      dropBox.classList.remove('dragover');
    });
    dropBox.addEventListener('drop', e => {
      e.preventDefault();
      dropBox.classList.remove('dragover');
      if (e.dataTransfer.files.length) {
        resumeInput.files = e.dataTransfer.files;
        showFileInfo();
      }
    });
    resumeInput.addEventListener('change', showFileInfo);
    function showFileInfo() {
      if (resumeInput.files.length) {
        fileInfo.style.display = 'flex';
        fileName.textContent = resumeInput.files[0].name;
        fileCheck.style.display = 'inline-block';
      } else {
        fileInfo.style.display = 'none';
        fileCheck.style.display = 'none';
      }
    }

    // Handle form submit and AI-powered results rendering
    uploadForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      statusMsg.style.display = 'none';
      resultsSection.style.display = 'none';
      aiTipsBox.style.display = 'none';
      mascotReact('analyzing');
      analyzingOverlay.style.display = 'flex';
      analyzingBarFill.style.width = '0%';
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress = Math.min(progress + Math.random()*18+7, 92);
        analyzingBarFill.style.width = progress + '%';
      }, 600);
      const formData = new FormData(uploadForm);
      try {
        const res = await fetch('/analyze', { method: 'POST', body: formData });
        const data = await res.json();
        clearInterval(progressInterval);
        analyzingBarFill.style.width = '100%';
        setTimeout(() => { analyzingOverlay.style.display = 'none'; }, 700);
        if (data.error) throw new Error(data.error);
        renderResults(data.results, data.resume_summary);
        let topMatchScore = Math.max(...data.results.map(r => r.match_score));
        mascotReact('success', topMatchScore);
      } catch (err) {
        clearInterval(progressInterval);
        analyzingOverlay.style.display = 'none';
        statusMsg.style.display = 'block';
        statusMsg.textContent = 'Error: ' + err.message;
        mascotReact('idle');
      }
    });

    function renderResults(results, summary) {
      statusMsg.style.display = 'none';
      resultsSection.innerHTML = '';
      resultsSection.style.display = 'flex';
      // --- Animated Overall Score ---
      let topMatchScore = Math.max(...results.map(r => r.match_score));
      let avgScore = (results.reduce((a,b)=>a+b.match_score,0)/results.length).toFixed(2);
      let topMatch = results.find(r => r.match_score === topMatchScore);
      // Animated Score
      const scoreDiv = document.createElement('div');
      scoreDiv.style = 'width:100%;text-align:center;margin-bottom:18px;';
      scoreDiv.innerHTML = `<div style="font-size:2.7rem;font-weight:800;color:var(--accent1);text-shadow:0 2px 18px #000;animation:bounceIn 1.2s;">Your Resume Score: <span id='animatedScore'>0</span>/10</div>`;
      resultsSection.appendChild(scoreDiv);
      // Animate the score
      let score = 0;
      const targetScore = topMatchScore;
      const scoreSpan = () => document.getElementById('animatedScore');
      const scoreInterval = setInterval(()=>{
        if(score < targetScore){ score+=0.1; scoreSpan().textContent = score.toFixed(1); }
        else { scoreSpan().textContent = targetScore.toFixed(1); clearInterval(scoreInterval); }
      }, 30);
      // --- Pie Chart: Skill Match Breakdown ---
      const pieDiv = document.createElement('div');
      pieDiv.style = 'width:320px;max-width:90vw;margin:0 auto 18px auto;background:var(--surface);border-radius:18px;padding:18px 0;box-shadow:0 2px 18px rgba(0,0,0,0.10);';
      pieDiv.innerHTML = `<canvas id='pieChart' width='320' height='180'></canvas>`;
      resultsSection.appendChild(pieDiv);
      // --- Bar/Line Graph: Compare to Top Candidates ---
      const barDiv = document.createElement('div');
      barDiv.style = 'width:420px;max-width:98vw;margin:0 auto 18px auto;background:var(--surface);border-radius:18px;padding:18px 0;box-shadow:0 2px 18px rgba(0,0,0,0.10);';
      barDiv.innerHTML = `<canvas id='barChart' width='420' height='180'></canvas>`;
      resultsSection.appendChild(barDiv);
      // --- AI-Generated Candidate Description ---
      const descDiv = document.createElement('div');
      descDiv.style = 'width:100%;max-width:540px;margin:0 auto 18px auto;background:var(--glass);border-radius:18px;padding:18px 24px;font-size:1.18rem;color:var(--text);box-shadow:0 2px 18px rgba(0,0,0,0.10);text-align:center;';
      descDiv.innerHTML = `<strong>AI says:</strong> <span style='color:var(--accent3);'>${summary}</span>`;
      resultsSection.appendChild(descDiv);
      // --- Badges/Awards ---
      const badgesDiv = document.createElement('div');
      badgesDiv.style = 'width:100%;text-align:center;margin-bottom:18px;';
      let badges = [];
      if(topMatchScore>=9) badges.push('🌟 Resume Rockstar');
      if(topMatchScore>=8) badges.push('🔥 Top 10% Communicator');
      if(avgScore>=7.5) badges.push('💡 Skill Match Pro');
      if(results.length>=3) badges.push('🎯 Multi-Role Fit');
      badgesDiv.innerHTML = badges.length ? badges.map(b=>`<span style='display:inline-block;margin:0 8px 8px 0;padding:8px 18px;background:var(--accent1);color:var(--bg);border-radius:16px;font-weight:700;font-size:1.08rem;box-shadow:0 2px 8px rgba(255,221,51,0.13);animation:fadeInDown 1.1s;'>${b}</span>`).join('') : '';
      resultsSection.appendChild(badgesDiv);
      // Confetti for badges
      if(badges.length){ setTimeout(()=>{ confetti({ particleCount: 80, spread: 90, origin: { y: 0.5 }, colors: ["#FFCC00", "#FF4F0F", "#FF66B3"] }); }, 800); }
      // --- Render per-role cards as before ---
      results.forEach((match, i) => {
        const card = document.createElement('div');
        card.className = 'result-card animate__animated' + (match.match_score === topMatchScore ? ' top-match' : '');
        card.innerHTML = `
          ${match.match_score === topMatchScore ? '<div class="result-badge">Top Match</div>' : ''}
          <img src="/static/company-logos/${match.company.toLowerCase().replace(/\s/g,'')}.svg" alt="${match.company} logo" class="result-company-logo" loading="lazy" />
          <div class="result-role">${match.role}</div>
          <div class="result-company">🏢 <strong>${match.company}</strong></div>
          <div class="result-salary">💰 <strong>${match.expected_salary}</strong></div>
          <div class="result-score">
            <div class="circular-score">
              <svg width="56" height="56">
                <circle cx="28" cy="28" r="24" stroke="#222" stroke-width="6" fill="none" />
                <circle cx="28" cy="28" r="24" stroke="${match.match_score > 8 ? '#00ff99' : (match.match_score > 6 ? '#FFCC00' : '#ff5555')}" stroke-width="6" fill="none" stroke-dasharray="150.72" stroke-dashoffset="${150.72 - (150.72 * match.match_score / 10)}" style="transition:stroke-dashoffset 1.2s;" />
              </svg>
              <span class="score-text">${Math.round(match.match_score*10)}%</span>
            </div>
            <span style="color:var(--subtle);font-size:1.05rem;">Match Score</span>
          </div>
          <div class="skills-list">
            ${match.matched_skills.map(skill => `<span class="skill-badge matched">${skill}</span>`).join('')}
            ${match.missing_skills.map(skill => `<span class="skill-badge missing">${skill}</span>`).join('')}
          </div>
          <div class="improvement-tips">
            <strong>AI Tips:</strong><br>${match.improvement_tips.replace(/\n/g,'<br>')}
          </div>
        `;
        resultsSection.appendChild(card);
      });
      // --- Pie Chart Data ---
      const allSkills = [...topMatch.matched_skills, ...topMatch.missing_skills];
      const pieData = {
        labels: ['Matched Skills', 'Missing Skills'],
        datasets: [{
          data: [topMatch.matched_skills.length, topMatch.missing_skills.length],
          backgroundColor: ['#00ff99', '#ff5555'],
          borderWidth: 2
        }]
      };
      new Chart(document.getElementById('pieChart').getContext('2d'), {
        type: 'pie', data: pieData, options: {responsive:true,plugins:{legend:{display:true},title:{display:true,text:'Skill Match Breakdown',font:{size:18}}}}
      });
      // --- Bar/Line Chart Data ---
      const barData = {
        labels: results.map(r=>r.role),
        datasets: [{
          label: 'Match Score',
          data: results.map(r=>r.match_score),
          backgroundColor: results.map(r=>r.match_score === topMatchScore ? '#FFDD33' : '#2b7cff'),
          borderColor: '#222',
          borderWidth: 2,
          borderRadius: 8,
        }]
      };
      new Chart(document.getElementById('barChart').getContext('2d'), {
        type: 'bar', data: barData, options: {responsive:true,plugins:{legend:{display:false},title:{display:true,text:'Your Score vs. Top Roles',font:{size:18}}},scales:{y:{beginAtZero:true,max:10}}}
      });
      // Floating AI tips box (show tips for top match)
      if (topMatch && topMatch.improvement_tips) {
        aiTipsBox.style.display = 'flex';
        aiTipsContent.innerHTML = `<strong>How to improve for <span style='color:var(--accent2)'>${topMatch.role}</span> at <span style='color:var(--accent1)'>${topMatch.company}</span>:</strong><br><ul style='margin:8px 0 0 0;padding-left:18px;'>${topMatch.improvement_tips.split('\n').map(tip => `<li>${tip}</li>`).join('')}</ul>`;
      }
    }
    // Add radar chart rendering
    function renderRadarChart(skillCategories) {
      const radarDiv = document.createElement('div');
      radarDiv.style = 'width:340px;max-width:90vw;margin:0 auto 18px auto;background:var(--surface);border-radius:18px;padding:18px 0;box-shadow:0 2px 18px rgba(0,0,0,0.10);';
      radarDiv.innerHTML = `<canvas id='radarChart' width='340' height='220'></canvas>`;
      resultsSection.appendChild(radarDiv);
      new Chart(document.getElementById('radarChart').getContext('2d'), {
        type: 'radar',
        data: {
          labels: Object.keys(skillCategories),
          datasets: [{
            label: 'Skill Category Strength',
            data: Object.values(skillCategories),
            backgroundColor: 'rgba(43,124,255,0.18)',
            borderColor: 'rgba(43,124,255,1)',
            borderWidth: 2,
            pointBackgroundColor: 'var(--accent1)',
          }]
        },
        options: {
          responsive:true,
          plugins:{legend:{display:false},title:{display:true,text:'Skill Category Strength',font:{size:18}}},
          scales: {r: {beginAtZero:true,max:10}}
        }
      });
    }
    // Aurora Mesh Animation
    const auroraCanvas = document.getElementById('aurora-bg');
    const ctx = auroraCanvas.getContext('2d');
    let width = window.innerWidth;
    let height = window.innerHeight;
    function resizeAurora() {
      width = window.innerWidth;
      height = window.innerHeight;
      auroraCanvas.width = width;
      auroraCanvas.height = height;
    }
    window.addEventListener('resize', resizeAurora);
    resizeAurora();
    // Aurora mesh blobs
    const blobs = [
      {x: 0.3, y: 0.4, r: 320, c: [255,221,51], a: 0.22, dx: 0.12, dy: 0.09},
      {x: 0.7, y: 0.5, r: 420, c: [0,240,255], a: 0.18, dx: -0.09, dy: 0.11},
      {x: 0.5, y: 0.7, r: 340, c: [255,102,179], a: 0.16, dx: 0.07, dy: -0.08},
      {x: 0.6, y: 0.3, r: 260, c: [255,79,15], a: 0.13, dx: -0.11, dy: 0.06}
    ];
    function drawAurora() {
      ctx.clearRect(0,0,width,height);
      blobs.forEach(b => {
        const grad = ctx.createRadialGradient(
          b.x*width, b.y*height, b.r*0.2,
          b.x*width, b.y*height, b.r
        );
        grad.addColorStop(0, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},${b.a*1.2})`);
        grad.addColorStop(0.5, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},${b.a})`);
        grad.addColorStop(1, `rgba(${b.c[0]},${b.c[1]},${b.c[2]},0)`);
        ctx.beginPath();
        ctx.arc(b.x*width, b.y*height, b.r, 0, 2*Math.PI);
        ctx.fillStyle = grad;
        ctx.fill();
      });
    }
    function animateAurora() {
      blobs.forEach(b => {
        b.x += 0.0015 * b.dx;
        b.y += 0.0015 * b.dy;
        if(b.x < 0.1 || b.x > 0.9) b.dx *= -1;
        if(b.y < 0.1 || b.y > 0.9) b.dy *= -1;
      });
      drawAurora();
      requestAnimationFrame(animateAurora);
    }
    animateAurora();
    // Hide old wave background if present
    const waveBg = document.getElementById('wave-bg');
    if(waveBg) waveBg.style.display = 'none';
    // Ripple effect for upload button
    document.querySelectorAll('.upload-btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        const rect = this.getBoundingClientRect();
        const ripple = document.createElement('span');
        ripple.className = 'ripple-effect';
        ripple.style.width = ripple.style.height = Math.max(rect.width, rect.height) + 'px';
        ripple.style.left = (e.clientX - rect.left - rect.width/2) + 'px';
        ripple.style.top = (e.clientY - rect.top - rect.height/2) + 'px';
        this.appendChild(ripple);
        setTimeout(() => ripple.remove(), 600);
      });
    });
    // Mascot personality and reactions (interactive, keyboard accessible)
    const mascotAnim = document.getElementById('mascotAnim');
    const mascotLottie = document.getElementById('mascotLottie');
    const mascotSpeech = document.getElementById('mascotSpeech');
    const mascotSpeechText = document.getElementById('mascotSpeechText');
    let mascotState = 'idle';
    function showMascotSpeech(text, duration=3500) {
      mascotSpeechText.textContent = '';
      mascotSpeech.style.display = 'block';
      // Animated typing effect
      let i = 0;
      function type() {
        if (i < text.length) {
          mascotSpeechText.textContent += text[i++];
          setTimeout(type, 18);
        }
      }
      type();
      setTimeout(() => { mascotSpeech.style.display = 'none'; }, duration + text.length*18);
    }
    // Mascot hover/click/keyboard reactions
    mascotLottie.addEventListener('mouseenter', () => {
      mascotLottie.setSpeed(1.7);
      showMascotSpeech('👋 Hi! I’m SkillWale, your AI career buddy!');
    });
    mascotLottie.addEventListener('mouseleave', () => mascotLottie.setSpeed(1));
    mascotLottie.addEventListener('click', () => {
      mascotLottie.setSpeed(2.2);
      showMascotSpeech('Need a tip? Upload your resume and I’ll help you shine!');
      setTimeout(() => mascotLottie.setSpeed(1), 1200);
    });
    mascotAnim.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        mascotLottie.setSpeed(2.2);
        showMascotSpeech('Let’s get started! Upload your resume below.');
        setTimeout(() => mascotLottie.setSpeed(1), 1200);
      }
    });
    // Mascot reacts to analysis
    function mascotReact(state, matchScore) {
      if (state === 'analyzing') {
        mascotLottie.setSpeed(1.5);
        showMascotSpeech('Analyzing your resume... 🤔');
      } else if (state === 'success') {
        mascotLottie.setSpeed(1);
        if (matchScore >= 8) {
          showMascotSpeech('🎉 Amazing! You’re a top match!');
        } else if (matchScore >= 6) {
          showMascotSpeech('Great job! Here’s how to get even better.');
        } else {
          showMascotSpeech('Don’t worry! I’ve got tips to help you improve.');
        }
      } else if (state === 'idle') {
        mascotLottie.setSpeed(1);
        mascotSpeech.style.display = 'none';
      }
    }
    // Add modal logic for interview questions
    const interviewModal = document.getElementById('interviewModal');
    const closeInterviewModal = document.getElementById('closeInterviewModal');
    const interviewQuestionsList = document.getElementById('interviewQuestionsList');
    function showInterviewQuestions(questions) {
      interviewQuestionsList.innerHTML = questions.map(q => `<li>${q}</li>`).join('');
      interviewModal.style.display = 'flex';
    }
    closeInterviewModal.onclick = () => { interviewModal.style.display = 'none'; };
    window.onclick = (e) => { if(e.target === interviewModal) interviewModal.style.display = 'none'; };
    // Download report logic
    const downloadReportBtn = document.getElementById('downloadReportBtn');
    downloadReportBtn.onclick = async function() {
      const summary = document.querySelector('.hero-sub').textContent;
      const results = window.lastResults || [];
      const tips = window.lastResumeTips || [];
      const res = await fetch('/download_report', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ summary, results, tips })
      });
      const blob = await res.blob();
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'SkillWale_Resume_Report.txt';
      document.body.appendChild(a);
      a.click();
      a.remove();
      window.URL.revokeObjectURL(url);
    };
    // In renderResults, after rendering results, store for download
    window.lastResults = results;
    window.lastResumeTips = summary;
  </script>
</body>
</html>
